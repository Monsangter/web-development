악성 코드 분석을 위한 네트워크 트래픽 분석.
src= https://www.inflearn.com/course/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%ED%8C%A8%ED%82%B7-%EB%B6%84%EC%84%9D-%EC%9E%85%EB%AC%B8-%EB%B0%8F-%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C-%EC%83%98%ED%94%8C-%EB%B6%84%EC%84%9D# 인프런 보안프로젝트

초~중급자를 위한강의.

네트워크 트래픽 분석과 악성코드 어떻게 연결할 수 있는지.
네트워크 기초부터 살펴봄~
실질적으로 필요한것~
네트워크를 실제로 패킷들로 분석
머리어 트래픽 분석을 위해서 사용 도구 튜터리얼
연습 샘플 분석
자바스크립트 난독화, 웹 클라이언트 사이드쪽에서 보통 쓰이는 언어임.dbd같은 공격등이 난독화와 함꼐 들오기도함 네트워크 트래픽에서 http타고 들오기더함
ek라고 익스프롤러 킷이 잇는데 여기서 난독화를 진행해줌 ek마다 난독화 방식 다르기 떔에 난해할 수 잇지만 어느정도 이후에 문맥을 파악할 수 잇을 정도로는 진행해줌. 실제 사례들을 들어가면서 어떻게 이런 자바스크립트 난독화와 와이어샤크 네트워크를 통해서 어떻게 사건이 진행 됏엇는지 또는 머래어가 어떻게 동작하는지를 네트워크라는 큰틀에서 악성코드도 크게 시스템 족에 파트가 있기때문에, 이번엔 네트워크에 촛점맞춰서 진행해봄.


1. 네트워크 트래픽 분석과 악성코드

네트워크 트래픽분석을통해 악성코드랑 어캐 연관대잇는지 분석해봄. 악성코드를 분석하는데 네트워크 트래픽이 왜 필요할까 악성코드도 네트워크가 발전함에 따라서 같이 발전하는 사례를 같이 역사를 볼수잇슴

옛날에는 네트워크가 발달안돼서 악성코드가 네트워크로 전파가 안댓음. 플로피 디스크나 다른 매체를 통해 전파가 됏다면 오늘날엔 초고상인터넷이 디폴트기 땜에 악성코드와 항상 연결돼 잇음.

군용 연구용으로 쓰이다 2000ㄴ년대 민간 상업용으로 전세계적 이용. 기술이 좋아지만 안정성 떨어짐. 한국이 네트워크 발달하긴햇는데 문제 생길수도잇는양상

01 악성코드 분석에 네트워크 트래픽이 필요할까

실질적으로 악성코드(실험적 자기복제코드)가 등장한 시점은 71년, 잠잠하다 86년부터 급격히 개체수와 종 증가. 이후 백신역사도 시작

총 악성코드 개수 지수적 상승. 신종출현은 수그러듬. 보급속도보다 몇년 늦음. 보급된후 몇년뒤 악성코드가 따라 는다는 말.

02 악성코드는 대부분 네트워크 트래픽을 타고 이동한다.

악성코드는 어떻게 네트워크 트래픽 타고 이동하나. 초창기 악성코드는 디스켓을 통해 이동 했으나 오늘날 악성코드는 인터넷 통해 전파.

 -1 브라우저를 통한 악코유포
 -2 불법크랙프로그램을 사용한 유포
 -3 피싱/파밍을 통한 유포
 -4 외부문서 매크로를 통한 유포.

03 네트워크 악성코드 실제 사례

 -1 브라우저 
 고전적임. 검색만으로도 유포되고, 특히 (힙취약점 이용)ie버전과 fláh취약점 조합으로 유포. 가끔 크롬을 통해서도 유포. 랜섬웨어가 이런 식으로 전파. 보안시스템 잇어도 연구해서 우회함. 계속 진화.
ie강이는 아니나 윈도 애플리케이션 취약점 분석이라는 강의도 잇음. (stack쪽 취약점 이용) 이 강의에서 취약점은 다루지 않는데 패킷이 어떻게 왓다갓다 하는지 정도는 다뤄보겟다.

 -2 불법 크랙 프로그램 사용
 웹하드, p2p,블로그 통해 유포. 공짜 좋아하는 불법 사용자 노리고 악성코드 같이 심어놈. 심지어 알고서도 실시간 감시기능 끄라고해서 끄는경우도잇음. trojan있을 확률 높음(몰래 로컬에 다운로드 받아놓음)

 -3 피싱 파밍을 통한 악성코드 유포.
 사용자를 속에 공격자가 임의로 만든 사이트에 접속하게 한뒤, 개인정보 입력하게하는 사회공학적 방법.
실제 페이스북측에서도 api를 잘만들어 제공하고 개인정보를 조금은 요구하기는 하는데, 아이디와 패스워드를 직접적으로 요구하지 않음. 패스워드도 해시로 저장함.

 -4 외부 문서 매크로 사용 
 이메일 등으로 스팸오는 문서를 보면 hwp,pdf,excel,word 첨부 일반 사용자의 경우 exe파일이나 zip파일만 경계하기도 하는데 매크로가 첨부된 파일일 수도 있음. 한글, pdf의 경우 취약점을 주로 이용하고, excel과 word의 경우 대부분 ms office에서 제공하는 매크로로 악성 코드 유포.

04 네트워크 분석이 악성코드분석에 미치는 영향.

 -1 악성코드의 정확한 행위 파악
	대부분의 악성코드가 네트워크 트래픽을 주로 사용(랜섬웨어 디도스 원격프로그램 조정, 트로젠 등) 디도스 공격을 위한 좀비 pc모으기, 특정 사용자 감시. 파일을 인질로 돈 요구하는 행위. 악성코드의 직접행위를 알아내기 위해서는 네트워크 트래픽 분석 필요. 
	악성코드가 시스템쪽에서 oedbg나, 디버깅을 해서 파악가능한 부분이 있고 실질적으로 네트워크 트래픽이 필요한 부분도 있다. 네트워크 트래픽이 중간에 멈추면은 갑자기 진행이 안되는 경우도 있고 cnc서버가 살아있다면 주로 이런 cnc서버와의 통신을 통해서. 이런 네트워크 트래픽을 활용한다는거다. 없으면 임시방편으로 임의 서버 올려, 테스
	팅 하기도함.

 -2 악성코드 네트워크 흐름에서 탐지 및 차단

	ids장비등에서 네트워크 패킷을 감시하는데 필요.
	우리가 추출한 패턴에서 패턴이 abcd로가는 문자열로 흘러간다. 어디에서도 볼 수없던 패턴이다 하면은 ids장비에다 등록 해놓음. 오른보안 업체 가비아의 보안 장비 설치사례 보면 백본 - ngfirewall - waf -switch -servergorup
																				-(mirroring) IDS 
	백본에서 서버 그룹사이에 트래픽이 왔따갔따 하고 ids는 그중간에서 패킷을 미러링함. 패킷에 특정 문자열(악성코드 삽입)을 발견하면 위험알림.

05 네트워크 분석에 필요한 것들
 -네트워크 기초 이론 
  na나 np같은 공부도 해봣는데 불필요한거 뺴고  네트워크 기초이론부터 해서 진행할 예정이다. 

 -네트워크 프로토콜 구조와 이해
  이론적으로 헤더가 어떻게 생겨느니 같은 것도 살표본다. 근데 와이어 샤크로 실제 패킷확인도 해보겟음.

 -네트워크 분석 툴
  네트워크 관련해서 공부하면 시스코장비 같은거 다루는 방법 배우긴 하는데 네트워크 트래픽이 어떻게 왓다갓다하는지는 안배움. 이건 실제로 왔따갔다 하는 패킷이 어떤 역할을 하고 의미를 갖는지, 둘이 왓다갓다 하는걸 바이너리 형태로 보면 전혀 모름. 글키떔에 툴을 사용하면 자동화 되어서. 단순하게 분석 가능하다. 이런 툴에대한, 도구에 대한 이해를 해본다. 

 -실제 악성코드 트래픽 분석경험

전지해줄수잇는건 전지해주고 악성코드가 어떻게 전파되는지 확인하는 시간 갖겠다.

가장 중요한건 이론. 그 바탕으로 프로토콜 구조 이해. 다음으로 분석 툴. 나는 데이터 분석을 기초부터 다갈킴. 관련된 라이블러리 잇으면 다 알려줌. 다른데는 일케 안갈치고 넘파이 좀 배우고 텐서플로 좀 배우고 함. 근데 나는 넘파이, 냄블로비? 배움. 이거 배우고 판다스로 넘어가니까 편하다. 네트워크도 중복된 라이브러리를 쓰고 잇기떔에, 굉장히 편하다. 근데 요즘 과정들 보면 넘파이 냄블로비 다 뻄. 글고 판다만 갈킴. 그럼 텐서플로 못함. 뉴럴 어쩌고 해야대는대 못함. 다시 배워야함. 저랑 같이하면 안해도댐. 네트워크도 마찬가지로 네트워크 기초안하면 망함. 프로토콜 이해 못하고, 툴 사용못함. 사용은 할지못해도 확장은 못함. 그래서 기초부터 해야댐.분석툴 버그 많아서 기초부터 알고 잇어야 문제안생김 기초부터차근차근 ㄱ. 실제 악성코드는 변칙 변수 난무. 그래서 확장이 적용되지 않으면 문제 생김. 기초를 다 익히면 필없는데 모르면 듣고 위단계로 넘어가삼.